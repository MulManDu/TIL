# JPA 프로그래밍
- 제목: 자바 ORM 표준 JPA 프로그래밍
- 부제: 스프링 데이터 예제 프로젝트로 배우는 전자정부 표준 데이터베이스 프레임워크
- 지은이: 김영한
- 출판사: 에어콘

## 메모
- 엔티티: 비즈니스 요구사항을 모델링한 객체이다.
- JPA: JPA는 자바의 ORM 표준 기술이다. 하이버이트는 이 기술을 구현하여 API를 제공해주는 프레임워크이다.

### SQL을 직접 다룰 때 발생하는 문제점
1. 진정한 의미의 계층 분할이 어렵다: 필드를 하나 추가하면 DAO 객체와 SQL문을 수정해야 한다. 물리적으로 분할이 되었을 뿐, 엔티티와 의존성이 높다.
2. 엔티티를 신뢰할 수 없다: SQL, JDBC API와 엔티티가 서로 의존적이기 때문에 변경이 발생할 시, 잘못된 결과를 얻을 수 있다.
3. SQL에 의존적인 개발을 피하기 어렵다

### 패러다임의 불일치
복잡한 어플리케이션은 유지보수를 위해 객체지향 개념을 사용한다. 객체지향 프로그래밍은 추상화, 캡슐화, 정보은닉, 상속, 다형성 등 시스템의 복잡성을 제어할 수 있는 다양한 장치들을 제공한다.
브지니스 요구사항을 정의한 도메인 모델도 객체로 모델링하면 객체지향 언어가 가진 장점들을 활용할 수 있다. 

관계형 데이터베이스는 데어티 중심을 구조화되어 있고, 집합적 사고를 요구한다. 그리고 객체 지향에서 이야기하는 추상화, 상속, 다형성 같은 개념이 없다.

객체와 관계형 데이터베이스는 지향하는 목적이 서로 다르므로 둘의 기능과 표현 방법도 다르다. 이것을 객체와 관계형 데이터베이스의 패러다임 불일치 문제라 한다. 따라서 객체 구조를 테이블 구조에 저장하는 데는 한계가 있다. 이것을 해결하는 위해 등장한 것이 ORM 기능을 가진 JPA이다. 

#### 상속
객체는 상속이라는 기능을 가지고 있지만 테이블은 상속이라는 기능이 없다. JPA에서는 상속 관계가 있는 두 테이블에 자동으로 데이터를 inset 해준다.

#### 연관관계
객체는 참조를 사용해서 다른 객체와 연관관계를 가지고 참조에 접근해서 연관된 객체를 조회한다. 반면에 테이블은 외래 키를 사용해서 다른 테이블과 연관관계를 가지고 조인을 사용해서 연관된 테이블을 조회한다.
객체는 참조가 있는 방향으로만 조회할 수 있다. member.getTeam()은 가능하지만, team.getMember()는 불가능하다. 반면에 테이블은 외래 키 하나로 member join team도 가능하지만 team join memeber도 가능하다.

#### 객체를 테이블에 맞추어 모델링
객체에 테이블처럼 외래키를 맴버로 두면 객체를 테이블에 저장하거나 조회할 때 편리하다. 하지만 연관된 객체를 참조하기 힘들다. 그리고 이런 방식을 따르면 좋은 객체 모델링은 기대하기 어렵고 결국 객체지향의 특징을 잃어버리게 된다.

#### 객체지향 모델링
객체는 참조를 통해서만 관계를 맺는다. 객체지향 모델링을 사요하면 객체를 테이블에 저장하거나 조회하기가 쉽지 않다. 객체는 외래키는 필요 없고 참조만 있으면 된다. 테이블은 외래키만 있으면 된다. 개발자가 중간에서 변환 역할을 해야 한다. JPA를 사용하면 meember.setTeam(team)으로 연관관계를 설정하고 저장하면 된다.